<div align=center>
<font size="6"><b>《SVM笔记系列之三》最优化问题和（广义）拉格朗日乘数法</b></font> 
</div>

# 前言
**在SVM的推导中，出现了核心的一个最优化问题，这里我们简单介绍下最优化问题，特别是带有约束的最优化问题，并且引入拉格朗日乘数法和广义拉格朗日乘数法，用于解决带约束的最优化问题。**
**如有谬误，请联系指正。转载请注明出处。**
*联系方式：*
**e-mail**: `FesianXu@163.com`
**QQ**: `973926198`
**github**: `https://github.com/FesianXu`
**有关代码开源**: [click][click]

*****


# 最优化问题
我们在高中，包括在高数中都会经常遇到求解一个函数的最小值，最大值之类的问题，这类问题就是属于最优化问题。比如给出下列一个不带有约束的最优化问题：
$$
\min_{x} 3x^2+4x+5, x \in R
\tag{1.1}
$$
其中的$3x^2+4x+5$我们称为**目标函数(objective  function)**。这样的问题，直接利用**罗尔定理（Rolle's theorem）**求出其鞍点，又因为其为凸函数而且可行域是整个$R$，求出的鞍点便是最值点，这个是对于无约束最优化问题的解题套路。
如果问题带有约束条件，那么就变得不一样了，如：
$$
\min_{x, y} 3xy^2
$$
$$
s.t.　　　4x+5y = 10
\tag{1.2}
$$
因为此时的约束条件是**仿射函数（affine function）**[^1]，所以可以利用换元法将$x$表示为$y$的函数，从而将目标函数变为无约束的形式，然后利用罗尔定理便可以求出最值点了。
然而如果约束条件一般化为$g(x, y) = c$，那么$x$就不一定可以用其他变量表示出来了，这个时候就要利用**拉格朗日乘数法(Lagrange multipliers )**了。

# 拉格朗日乘数法(Lagrange multipliers)
我们先一般化一个二元最优化问题为$(2.1)$形式：
$$
\min_{x, y} f(x, y)
$$
$$
s.t.　　g(x, y) = c
\tag{2.1}
$$
将目标函数$f(x, y)$和等式约束条件$g(x, y)=c$画出来就如下图所示：
![general_min][general_min]
其中的$f(x, y)$虚线为等高线，而红线为$g(x, y)=c$这个约束函数曲线与$f(x,y)$的交点的连线。其中，假设有$d_3 > d_2 > d_1$， $d_1$点为最小值点（最优值点）。**从直观上可以发现，在$g(x,y)=c$与$f(x,y)$的非最优化交点A,B,C,D上，其$f(x,y)$和$g(x,y)$的法线方向并不是共线的，注意，这个相当关键，因为如果不是共线的，说明$g(x,y)=c$与$f(x,y)$的交点中，还存在可以取得更小值的点存在。对于A点来说，B点就是更为小的存在。因此，我们从直觉上推论出只有当$g(x,y)=c$与$f(x,y)$的法线共线时，才是最小值点的候选点（鞍点）。推论到多元变量的问题的时候，法线便用梯度表示**。于是，我们有原问题取得最优值的必要条件：
$$
\nabla f(x,y) = \nabla \lambda (g(x, y)-c)
\tag{2.2}
$$
$(2.2)$其中的$\lambda$表示两个梯度共线。
可以简单的变形为
$$
\nabla L(x, y, \lambda) = \nabla f(x,y) - \nabla \lambda (g(x, y)-c) = 0
\tag{2.3}
$$
让我们去掉梯度算子，得出
$$
L(x, y, \lambda) = f(x, y) - \lambda(g(x, y) - c)
\tag{2.4}
$$
看！我们得出了我们高数中经常见到的**等式约束下的拉格朗日乘数函数的表示方法**。


# 广义拉格朗日乘数法(Generalized Lagrange multipliers)
上面我们的拉格朗日乘数法解决了等式约束的最优化问题，但是在**存在不等式约束的最优化问题**（包括我们SVM中需要求解的最优化问题）上，普通的拉格朗日乘数法并不能解决，因此学者提出了**广义拉格朗日乘数法（Generalized Lagrange multipliers）**， 用于解决含有不等式约束的最优化问题。




# 引用
1. [拉格朗日乘子法如何理解？ 知乎][ref_1]
2. [《统计学习方法》 豆瓣][ref_2]
3. [《【直观详解】拉格朗日乘法和KKT条件》  微信公众号][ref_3]


[click]: https://github.com/FesianXu/AI_Blog/tree/master/SVM%E7%9B%B8%E5%85%B3
[ref_1]: https://www.zhihu.com/question/38586401
[ref_2]: https://book.douban.com/subject/10590856/
[ref_3]: http://mp.weixin.qq.com/s?__biz=MzI4MDYzNzg4Mw==&mid=2247486230&idx=1&sn=41c3bcbf00b43535e912af1dab2704f5&chksm=ebb433c2dcc3bad45fa784314d4ea6a464538ff19b937b58bd99f12b43ec3c3cf01a269f9124&mpshare=1&scene=23&srcid=11211sArM7yh9Xf0pkvnWaJA#rd


[general_min]: ./imgs/general_min.png


[^1]: 最高次数为1的多项式，形如 $f(x) = AX+B$，其中$X$是$m \times k$的仿射矩阵，其与线性函数的区别就是，线性函数是$f(x) = AX$没有偏置项$B$。